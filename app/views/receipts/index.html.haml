#receipts.margin2bottom{ data: { codes: User.customers.map(&:code).map(&:presence).compact.sort.to_json } }
  .row-fluid
    .span12
      .margin2bottom
        %table.table.table-bordered.navigation
          %tr
            %td.first.date
              = select_year @current_time.to_date, start_year: 2011, end_year: Time.now.year
              = select_month @current_time.to_date, use_month_numbers: true
              = hidden_field_tag :date_day, @current_time.day
            - time = Time.now.beginning_of_month
            - while time.month == Time.now.end_of_month.month
              - if time.day == @current_time.day
                %td{ class: 'current' }
                  - if @grouped_paper_processes[time.day].present?
                    = link_to time.day, "/receipts/#{@current_time.year}/#{@current_time.month}/#{time.day}"
                  - else
                    = time.day
              - else
                - if @grouped_paper_processes[time.day].present?
                  %td{ class: 'present' }= link_to time.day, "/receipts/#{@current_time.year}/#{@current_time.month}/#{time.day}"
                - else
                  %td
                    - if time.to_date == Time.now.to_date
                      = link_to time.day, "/receipts/#{@current_time.year}/#{@current_time.month}/#{time.day}"
                    - else
                      = time.day
              - time = time + 1.day
  .alerts
    = render partial: 'shared/messages'
  .row-fluid
    .span12
      %table.table.table-bordered.condensed
        %tr
          %th.date            Heure
          %th.tracking_number NÂ° de suivi
          %th.customer_code   Code client
        - if @current_time.to_date == Date.today
          %tr.form
            = form_for @paper_process, url: receipts_path do |f|
              %td.date -
              %td.tracking_number
                != f.text_field :tracking_number, autofocus: true, maxlength: 13
                - if (error = @paper_process.errors.messages[:tracking_number].try(:first))
                  %br
                  %span.errors= error
              %td.customer_code
                != f.text_field :customer_code, maxlength: 15
                - if (error = @paper_process.errors.messages[:customer_code].try(:first))
                  %br
                  %span.errors= error
        - @grouped_paper_processes[@current_time.day].to_a.each do |paper_process|
          %tr
            %td.date=            l(paper_process.created_at, format: '%H:%M')
            %td.tracking_number= paper_process.tracking_number
            %td.customer_code=   paper_process.customer_code
