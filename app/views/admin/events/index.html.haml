#events
  .row
    .col-12
      %h3 Liste des événements
  .row
    .col-12
      .filter.panel.margin1top
        = form_tag admin_events_path, method: :get do
          = hidden_field_tag :direction, sort_direction
          = hidden_field_tag :sort,      sort_column
          = hidden_field_tag :per_page,  per_page

          %table.table.table-condensed.margin0bottom
            %thead
              %tr
                %th Total
                %th
                  = label_tag 'event_contains[id]', 'ID'
                %th
                  = label_tag 'event_contains[created_at][>=]', 'Date de début'
                %th
                  = label_tag 'event_contains[created_at][<=]', 'Date de fin'
                %th
                  = label_tag 'event_contains[user_contains][code]', t('activerecord.models.event.attributes.user')
                %th
                  = label_tag 'event_contains[action]', t('activerecord.models.event.attributes.action')
                %th
                  = label_tag 'event_contains[target_type]', t('activerecord.models.event.attributes.target_type')
                %th
                  = label_tag 'event_contains[target_name]', t('activerecord.models.event.attributes.target_name')
                %th
            %tbody
              %tr
                %td
                  - if @events.total_count != Event.count
                    %b= @events.total_count
                    sur
                    = Event.count
                  - else
                    %b= Event.count
                %td
                  = number_field_tag 'event_contains[id]', (params[:event_contains][:id] rescue ''), class: 'form-control'
                %td
                  .input-group
                    .input-group-prepend
                      %span.input-group-text= glyphicon('calendar')
                    = text_field_tag 'event_contains[created_at][>=]', (params[:event_contains][:created_at]['>='] rescue ''), class: 'form-control date datepicker'
                %td
                  .input-group
                    .input-group-prepend
                      %span.input-group-text= glyphicon('calendar')
                    = text_field_tag 'event_contains[created_at][<=]', (params[:event_contains][:created_at]['<='] rescue ''), class: 'form-control date datepicker'
                %td
                  = text_field_tag 'event_contains[user_contains][code]', (params[:event_contains][:user_contains][:code] rescue ''), class: 'form-control'
                %td
                  = select_tag 'event_contains[action]', event_action_options_for_select, include_blank: true, class: 'form-control'
                %td
                  = select_tag 'event_contains[target_type]', event_target_type_options_for_select, include_blank: true, class: 'form-control'
                %td
                  = text_field_tag 'event_contains[target_name]', (params[:event_contains][:target_name] rescue ''), class: 'form-control'
                %td
                  = submit_tag t('filters.action'), name: nil, class: 'btn btn-primary'
                  = link_to t('filters.reset'), admin_events_path, class: 'btn'

  .row
    .col-12
      = render partial: 'shared/list_options', locals: { collection: @events }
  .row
    .col-8
      %table.list.table.table-condensed.table-striped.panel.margin1top.margin0bottom
        %thead
          %tr.bg-brown.text-white
            %th.number=      sortable :id,          'ID'
            %th.date=        sortable :created_at,  'Date'
            %th=             sortable :user_id,     t('activerecord.models.event.attributes.user')
            %th=             sortable :action,      t('activerecord.models.event.attributes.action')
            %th=             sortable :target_type, t('activerecord.models.event.attributes.target_type')
            %th.target_name= sortable :target_name, t('activerecord.models.event.attributes.target_name')
        %tbody
          - @events.each do |event|
            - event_presenter = EventPresenter.new(event, self)
            %tr{ data: { id: event_presenter.id.to_s } }
              %td.do-show.number=      event_presenter.id
              %td.do-show.date=        event_presenter.created_at
              %td=                     event_presenter.user_code
              %td.do-show=             event_presenter.action
              %td.do-show=             event_presenter.target_type
              %td.do-show.target_name= event_presenter.target_name
    .col-4.show.margin1top.margin0bottom
      .panel
        %h4 Détails
        %p.margin0bottom
          Cliquer sur une ligne du tableau pour en afficher les détails ici.
  .row
    .col-12
      = render partial: 'shared/list_options', locals: { collection: @events }
