.user{ :class => "user_#{one_monthly.reporting.customer.id} #{"active" if !one_monthly.documents.empty?}" }
  .header
    .actiongroup.first.pull-left
      - if !one_monthly.documents.empty?
        %a.do-showThis.pull-left{ :href => "#", :style => "display:none;" }
          +
        %a.do-hideThis.pull-left{ :href => "#" }
          \-
    .title.pull-left
      %h3
        != format_user one_monthly.reporting.customer
    .state.pull-right
      - ustate = one_monthly.reporting.find_or_create_monthly_for(@year,index+1).delivery.state rescue "nothing"
      - state = Reporting::Delivery::STATES.index{|i| i[1] ==  ustate}
      - if state != 0
        - @total_state[state - 1] += 1
      .state1.pull-left{ :class => ("active" if state >= 1) }
        attendus
      .state2.pull-left{ :class => ("active" if state >= 2) }
        reçus
      .state3.pull-left{ :class => ("active" if state == 3) }
        traités
  .content.margin1top
    - if !one_monthly.documents.empty?
      %table
        %tr
          %th.first.documents Nom des documents
          %th.second.aligncenter Pièces
          %th.second.aligncenter Feuilles
          %th.second.aligncenter Pages
          %th.second Attaches  
          %th.second Hors format
        - total_pieces = 0
        - total_sheets = 0
        - total_pages = 0
        - total_uploaded_pieces = 0
        - total_uploaded_sheets = 0
        - total_uploaded_pages = 0
        - one_monthly.documents.each do |document|
          %tr
            %td.first.documents
              != document.name
            %td.second.aligncenter
              != document.pieces
              (#{document.pieces - document.uploaded_pieces rescue document.pieces},
              #{document.uploaded_pieces rescue 0})
              - total_pieces += document.pieces - document.uploaded_pieces rescue document.pieces
              - total_uploaded_pieces += document.uploaded_pieces rescue 0
            %td.second.aligncenter
              != document.sheets
              (#{document.sheets - document.uploaded_sheets rescue document.sheets},
              #{document.uploaded_sheets rescue 0})
              - total_sheets += document.sheets - document.uploaded_sheets rescue document.sheets
              - total_uploaded_sheets += document.uploaded_sheets rescue 0
            %td.second.aligncenter
              != document.pages
              (#{document.pages - document.uploaded_pages rescue document.pages},
              #{document.uploaded_pages rescue 0})
              - total_pages += document.pages - document.uploaded_pages rescue document.pages
              - total_uploaded_pages += document.uploaded_pages rescue 0
        %tr
          %td.first.documents
            %b
              Total
          %td.second.aligncenter
            %b
              != total_pieces + total_uploaded_pieces
              (#{total_pieces},
              #{total_uploaded_pieces})
          %td.second.aligncenter
            %b
              != total_sheets + total_uploaded_sheets
              (#{total_sheets},
              #{total_uploaded_sheets})
          %td.second.aligncenter
            %b
              != total_pages + total_uploaded_pages
              (#{total_pages},
              #{total_uploaded_pages})
          %td.second
          %td.second
          - @total_pieces_per_month += total_pieces
          - @total_sheets_per_month += total_sheets
          - @total_pages_per_month += total_pages
          - @total_uploaded_pieces_per_month += total_uploaded_pieces
          - @total_uploaded_sheets_per_month += total_uploaded_sheets
          - @total_uploaded_pages_per_month += total_uploaded_pages