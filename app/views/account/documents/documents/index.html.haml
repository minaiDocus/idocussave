//DocumentComposer widget
#documentcomposer
  //Actionbar
  .actionbar
    .feedback.inactive.floattoleft.margin1left
      %span.out
        Aucun traitement
        
    = label_tag :filtre, "Filtrer sur :", :class => "filterlabel floattoleft margin2top margin1right margin1left"
    = text_field_tag :filter, :class => "floattoleft"
    
    = check_box_tag :tags, "1", false, :class => "visibility floattoleft margin1left margin015top"
    = label_tag :tags, "Afficher les tags", :class => "floattoleft margin2top"
    
    %a.do-growlLegend{ :href => "#", :class => "floattoleft margin2left margin015top" }
      %span Légende
    /
      %a.do-openNewUploadDialog{ :href => "#", :class => "floattoleft margin2left margin015top" }
        %span{ :title => "Charger dans iDocus vos documents qui sont déjà en version numérique." } Téléverser
    
    %a{ :href => "#inline_doc", :class => "inline floattoleft margin2left margin015top" }
      %span{ :title => "Charger dans iDocus vos documents qui sont déjà en version numérique." } Téléverser
    
    :javascript
      $(document).ready(function() {
        $(".inline").colorbox({inline:true, width:"800px", height:"300px", scrolling:true, title:"Téléverser des documents"});
      });
    
    = link_to "Reporting", reporting_account_documents_path, :target => "_blank", :class => "floattoleft margin2left margin015top"
  
  //Page browser
  .pagesbrowser.scrollpane
    .titlebar.orders_scanned_title.margin1bottom
      %a.do-showDocuments{ :href => "#", :title => "Afficher/Cacher les documents", :class => "floattoleft margin1right margin1top" }
        %span.visibility Afficher
      %h1.floattoleft.margin07top
        %span documents
      
      %a.do-openNewSharingDialog{ :href => "#", :class => "floattoright margin1right margin1top inactive" }
        %span Partages
      %a.do-openNewDocumentsTaggingDialog{ :href => "#", :class => "floattoright margin1right margin1top inactive" }
        %span Tags
      %span.floattoright.margin2left.margin1right.margin1top Action :
      
      %a.do-deselectAllVisible{ :href => "#", :class => "floattoright margin1right margin1top" }
        %span Aucun
      %a.do-selectAllVisible{ :href => "#", :class => "floattoright margin1right margin1top" }
        %span Tous
      %span.floattoright.margin2left.margin1right.margin1top Sélection :
      
      = select_tag :per_page, options_for_select([["20",20],["50",50],["100",100]]), :class => "per_page floattoright margin1right margin07top"
      = label_tag :per_page, "par :", :class => "floattoright margin1right margin015top"

      = select_tag :document_owner_list, options_for_select([["tous","all"],["qui m'appartiennent","self"]]+linked_users_option), :class => "floattoright margin1right margin07top"
      = label_tag :document_owner_list, "Afficher les documents :", :class => "floattoright margin1right margin015top"
      
    %ul.documentslist.clearfix
      != render :partial => "pack", :collection => @packs
      
    %div.clear.margin2top.aligncenter.pagination
      != will_paginate( @packs, :previous_label => "&laquo; précedent", :next_label => "suivant &raquo;") if @packs
      = hidden_field_tag :packs_count, @packs_count
    
    .titlebar.pages_title.margin2top
      %a.do-showPages{ :href => "#", :title => "Afficher/Cacher les pages", :class => "floattoleft margin1right margin1top"}
        %span.visibility Afficher
      %h1.floattoleft.margin07top
        %span Pages
      
      %a.do-openNewPagesTaggingDialog{ :href => "#", :class => "floattoright margin1right margin1top inactive" }
        %span Tagger
      %span.floattoright.margin2left.margin1right.margin1top Action :
      
      %a.do-deselectAllPage{ :href => "#", :class => "floattoright margin1right margin1top" }
        %span Aucune
      %a.do-selectAllPage{ :href => "#", :class => "floattoright margin1right margin1top" }
        %span Toutes
      %span.floattoright.margin2left.margin1right.margin1top Sélection :
      
    %ul.pageslist.all.clearfix
    %ul.pageslist.find_result.clearfix
    .titlebar.composition_title.margin2top
      %a.do-showSelection.floattoleft.margin1right.margin1top{ :href => "#", :title => "Afficher/Cacher la sélection"}
        %span.visibility Afficher
      %h1.floattoleft.margin1bottom.margin07top
        %span Sélection
      
      %a.do-openNewCompositionDialog{ :href => "#", :class => "floattoright margin1right margin1top inactive" }
        %span Composer
      %span.floattoright.margin2left.margin1right.margin1top Action :
    %ul.pageslist.composition.clearfix
      - if @composition
        - @is_composition = true
        != render @composition
        - @is_composition = false

.hide
  .newSharingDialog
    %h3 Départager
    %p
      Pour refuser le partage, d'un autre utilisateur, de ce(s) document(s), cliquer sur le lien suivant : 
      = link_to "Départager", "#", :class => "do-unshareSelected"
      != image_tag "application/spinner_gray_alpha.gif", :id => "destroy_sharing_spinner", :class => "hide"
    %br
    %h3 Partager
    %p
      Pour partager ce(s) document(s) entrer l'identifiant du/des compte(s) concerné(s), séparer les identifiants des comptes avec des espaces.
      %br
      Identifiant(s) : 
      != text_field_tag :name, nil, :id => "sharing_name"
      != image_tag "application/spinner_gray_alpha.gif", :id => "new_sharing_spinner", :class => "hide"

.hide
  .newTaggingDialog
    %p
      Nom du tags
      %br
      != text_field_tag :tags, nil, :id => "tags_name"
      != image_tag "application/spinner_gray_alpha.gif", :id => "new_tagging_spinner", :class => "hide"
      %br
      Pour ajouter plusieurs tags à ce(s) document(s), separer les tags avec des espaces.
      Pour en retirer ajouter '-' devant le tag.

.hide
  .newCompositionDialog
    %p
      Nom de la composition
      %br
      != text_field_tag :composition, nil, :id => "composition_name"
      != image_tag "application/spinner_gray_alpha.gif", :id => "new_composition_spinner", :class => "hide"
    
.hide
  #inline_doc
    :plain
      <script>
        var fileUploadErrors = {
          maxFileSize: 'File is too big',
          minFileSize: 'File is too small',
          acceptFileTypes: 'Filetype not allowed',
          maxNumberOfFiles: 'Max number of files exceeded',
          uploadedBytes: 'Uploaded bytes exceed file size',
          emptyResult: 'Empty file upload result'
        };
      </script>
      <script id="template-upload" type="text/html">
      {% for (var i=0, files=o.files, l=files.length, file=files[0]; i<l; file=files[++i]) { %}
          <tr class="template-upload fade">
              <td class="name">{%=file.name%}</td>
              <td class="size">{%=o.formatFileSize(file.size)%}</td>
              {% if (file.error) { %}
                  <td class="error" colspan="2"><span class="label label-important">Erreur</span> {%=fileUploadErrors[file.error] || file.error%}</td>
              {% } else if (o.files.valid && !i) { %}
                  <td>
                      <div class="progress progress-success progress-striped active"><div class="bar" style="width:0%;"></div></div>
                  </td>
                  <td class="start">{% if (!o.options.autoUpload) { %}
                      <button class="btn btn-primary">
                          <i class="icon-upload icon-white"></i> Démarrer
                      </button>
                  {% } %}</td>
              {% } else { %}
                  <td colspan="2"></td>
              {% } %}
              <td class="cancel">{% if (!i) { %}
                  <button class="btn btn-warning">
                      <i class="icon-ban-circle icon-white"></i> Annuler
                  </button>
              {% } %}</td>
          </tr>
      {% } %}
      </script>
      <script id="template-download" type="text/html">
      {% for (var i=0, files=o.files, l=files.length, file=files[0]; i<l; file=files[++i]) { %}
          <tr class="template-download fade">
              {% if (file.error) { %}
                  <td></td>
                  <td class="name">{%=file.name%}</td>
                  <td class="error" colspan="2"><span class="label label-important">Erreur</span> {%=fileUploadErrors[file.error] || file.error%}</td>
              {% } else { %}
                  <td class="created_at">{%=file.created_at%}</td>
                  <td class="name">{%=file.name%}</td>
                  <td class="new_name">{%=file.new_name%}</td>
                  <td colspan="2"></td>
              {% } %}
          </tr>
      {% } %}
      </script>
    %p{ :style => "text-align:right" }
      Formats de fichiers acceptés : 
      %span{ :class => "label label-info", :style => "margin-right:5px;"} pdf
      %span{ :class => "label label-info", :style => "margin-right:5px;" } jpeg
      %span{ :class => "label label-info", :style => "margin-right:5px;" } jpg
      %span{ :class => "label label-info", :style => "margin-right:5px;" } gif
      %span{ :class => "label label-info", :style => "margin-right:5px;" } png
      %span{ :class => "label label-info", :style => "margin-right:5px;" } bmp
      %span{ :class => "label label-info", :style => "margin-right:5px;" } tiff
      %span{ :class => "label label-info" } tif
      %br
      %br
    %form{ :id => "fileupload", :action => "/account/documents/upload", :method => "POST", :enctype => "multipart/form-data" }
      = label_tag :account_book_type, "Type de document : ", :class => "floattoleft"
      = select_tag "account_book_type", options_for_select(account_book_types_option), :class => 'text_field', :id => "account_book_type", :style =>"position:relative;bottom:5px;margin-bottom:15px;"
      %br
      %br
      :plain
        <div class="row fileupload-buttonbar">
            <div class="span6">
                <span class="btn btn-success fileinput-button">
                    <span><i class="icon-plus icon-white"></i> Ajouter des fichiers...</span>
                    <input type="file" name="files[]" multiple>
                </span>
                <button type="submit" class="btn btn-primary start">
                    <i class="icon-upload icon-white"></i> Démarrer
                </button>
                <button type="reset" class="btn btn-warning cancel">
                    <i class="icon-ban-circle icon-white"></i> Annuler
                </button>
            </div>
            <div class="span6">
                <div class="progress progress-success progress-striped active fade">
                    <div class="bar" style="width:0%;"></div>
                </div>
            </div>
        </div>
        <br>
        <table class="table table-striped"><tbody class="files" data-toggle="modal-gallery" data-target="#modal-gallery"></tbody></table>
    
:css
  /**************HACK*************/
  body.application #worldwrapper #content .rightcolon {
    float: none; }
  #header {
    overflow: hidden; }
  .application {
    overflow-x: auto !important;
    overflow-y: hidden !important; }
  #documentcomposer ul.pageslist, #documentcomposer ul.documentslist {
    padding-left: 0 !important;
    padding-right: 0 !important; }