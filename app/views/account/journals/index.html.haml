.container-fluid
  = render partial: 'navigation'
  .row-fluid
    .span7
      %table.table.table-striped.table-bordered.table-condensed.margin1top
        %thead
          %tr
            %th{ rowspan: 2, style: 'vertical-align:middle' } Libellé court
            %th{ rowspan: 2, style: 'vertical-align:middle' } Libellé long
            %th{ rowspan: 2, style: 'vertical-align:middle' } Clients concernés
            %th{ colspan: 3 } Traitement Pré-Saisie ou NDF
            %th{ rowspan: 2, style: 'vertical-align:middle' } Action demandé à iDocus
            - if @user.is_editable
              %th{ rowspan: 2, style: 'vertical-align:middle' } Actions
          %tr
            %th Type
            %th N°
            %th Compte charge
        %tbody
          - @journals.each do |journal|
            - journal.update_request.try(:apply)
            %tr{ id: journal.slug }
              %td= render partial: 'account/shared/cell', locals: { instance: journal, key: 'name' }
              %td= render partial: 'account/shared/cell', locals: { instance: journal, key: 'description' }
              %td= render partial: 'account/shared/cell', locals: { instance: journal, key: 'clients_count' }
              %td= render partial: 'account/shared/cell', locals: { instance: journal, key: 'entry_type', is_translatable: true }
              %td= render partial: 'account/shared/cell', locals: { instance: journal, key: 'account_number' }
              %td= render partial: 'account/shared/cell', locals: { instance: journal, key: 'charge_account' }
              %td= t('request.'+journal.request_type) if journal.request_type.presence
              - if @user.is_editable
                %td
                  = link_to icon_edit, edit_account_account_book_type_path(journal)
                  = icon_link_to edit_requested_users_account_account_book_type_path(journal), { icon: 'user' }, { title: 'Clients concernés' }
                  - if journal.is_destroy_requested?
                    = link_to icon_ban_circle, cancel_destroy_account_account_book_type_path(journal), method: :post, data: { confirm: t('mongoid.models.account_book_type.request.confirm.cancel_destroy') }, title: 'Annuler la suppression'
                  - else
                    = link_to icon_destroy, account_account_book_type_path(journal), method: :delete, data: { confirm: t('mongoid.models.account_book_type.request.confirm.destroy') }
