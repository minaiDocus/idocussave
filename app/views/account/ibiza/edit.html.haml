#ibiza.edit
  .row-fluid
    .span12.box
      %h3 Configuration de iBiza
  .row-fluid
    .span12.box
      = simple_form_for (@ibiza || Ibiza.new), url: account_organization_ibiza_path(@organization), html: { class: 'form form-horizontal margin0bottom' } do |f|
        %fieldset
          %legend Connexion à iBiza pour le transfert des écritures
          = f.input :token, hint: link_to('Obtenir un jeton', "https://saas.irf-cloud.com/irfservice/get-token.aspx?partnerId=#{IbizaAPI::Config::PARTNER_ID}", target: '_blank')
          = f.input :is_auto_deliver, as: :boolean
        %fieldset
          %legend Format de nom de la pièce iDocus dans iBiza (colonne Pièces dans iBiza)
          %table.table.table-condensed
            %thead
              %tr
                %th Valeur
                %th Position
            %tbody
              %tr
                %td
                  %label.checkbox
                    = check_box_tag "ibiza[piece_name_format][code][is_used]", 1, (@ibiza.piece_name_format['code']['is_used'] rescue false)
                    %span.text Code complet
                %td= number_field_tag "ibiza[piece_name_format][code][position]", (@ibiza.piece_name_format['code']['position'] rescue 1)
              %tr
                %td
                  %label.checkbox
                    = check_box_tag "ibiza[piece_name_format][code_wp][is_used]", 1, (@ibiza.piece_name_format['code_wp']['is_used'] rescue false)
                    %span.text Code dossier sans code cabinet
                %td= number_field_tag "ibiza[piece_name_format][code_wp][position]", (@ibiza.piece_name_format['code_wp']['position'] rescue 1)
              %tr
                %td
                  %label.checkbox
                    = check_box_tag "ibiza[piece_name_format][journal][is_used]", 1, (@ibiza.piece_name_format['journal']['is_used'] rescue false)
                    %span.text Journal
                %td= number_field_tag "ibiza[piece_name_format][journal][position]", (@ibiza.piece_name_format['journal']['position'] rescue 1)
              %tr
                %td
                  %label.checkbox
                    = check_box_tag "ibiza[piece_name_format][period][is_used]", 1, (@ibiza.piece_name_format['period']['is_used'] rescue false)
                    %span.text Période de traitement
                %td= number_field_tag "ibiza[piece_name_format][period][position]", (@ibiza.piece_name_format['period']['position'] rescue 1)
              %tr
                %td
                  %label.checkbox
                    = check_box_tag "ibiza[piece_name_format][number][is_used]", 1, (@ibiza.piece_name_format['number']['is_used'] rescue false)
                    %span.text Numéro
                %td= number_field_tag "ibiza[piece_name_format][number][position]", (@ibiza.piece_name_format['number']['position'] rescue 1)
          = f.input :piece_name_format_sep
        %fieldset
          %legend Format de l'écriture comptable dans iBiza
          %table.table.table-condensed
            %thead
              %tr
                %th Valeur
                %th Position
                %th
            %tbody
              %tr
                %td
                  %label.checkbox
                    = check_box_tag "ibiza[description][operation_label][is_used]", 1, true, readonly: true
                    %span.text Libellé de l'opération bancaire
                %td= number_field_tag "ibiza[description][operation_label][position]", (@ibiza.description['operation_label']['position'] rescue 1)
                %td Obligatoire pour une opération provenant d'un automate bancaire.
              %tr
                %td
                  %label.checkbox
                    = check_box_tag "ibiza[description][date][is_used]", 1, (@ibiza.description['date']['is_used'] rescue false)
                    %span.text Date réelle
                %td= number_field_tag "ibiza[description][date][position]", (@ibiza.description['date']['position'] rescue 1)
                %td
              %tr
                %td
                  %label.checkbox
                    = check_box_tag "ibiza[description][third_party][is_used]", 1, (@ibiza.description['third_party']['is_used'] rescue false)
                    %span.text Tiers
                %td= number_field_tag "ibiza[description][third_party][position]", (@ibiza.description['third_party']['position'] rescue 1)
                %td
              %tr
                %td
                  %label.checkbox
                    = check_box_tag "ibiza[description][amount][is_used]", 1, (@ibiza.description['amount']['is_used'] rescue false)
                    %span.text Montant d'origine
                %td= number_field_tag "ibiza[description][amount][position]", (@ibiza.description['amount']['position'] rescue 1)
                %td
              %tr
                %td
                  %label.checkbox
                    = check_box_tag "ibiza[description][currency][is_used]", 1, (@ibiza.description['currency']['is_used'] rescue false)
                    %span.text Devise
                %td= number_field_tag "ibiza[description][currency][position]", (@ibiza.description['currency']['position'] rescue 1)
                %td
              %tr
                %td
                  %label.checkbox
                    = check_box_tag "ibiza[description][conversion_rate][is_used]", 1, (@ibiza.description['conversion_rate']['is_used'] rescue false)
                    %span.text Taux de conversion
                %td= number_field_tag "ibiza[description][conversion_rate][position]", (@ibiza.description['conversion_rate']['position'] rescue 1)
                %td
              %tr
                %td
                  %label.checkbox
                    = check_box_tag "ibiza[description][observation][is_used]", 1, (@ibiza.description['observation']['is_used'] rescue false)
                    %span.text Remarque
                %td= number_field_tag "ibiza[description][observation][position]", (@ibiza.description['observation']['position'] rescue 1)
                %td
              %tr
                %td
                  %label.checkbox
                    = check_box_tag "ibiza[description][journal][is_used]", 1, (@ibiza.description['journal']['is_used'] rescue false)
                    %span.text Journal
                %td= number_field_tag "ibiza[description][journal][position]", (@ibiza.description['journal']['position'] rescue 1)
                %td
              %tr
                %td
                  %label.checkbox
                    = check_box_tag "ibiza[description][piece_name][is_used]", 1, (@ibiza.description['piece_name']['is_used'] rescue false)
                    %span.text Nom de pièce (iDocus)
                %td= number_field_tag "ibiza[description][piece_name][position]", (@ibiza.description['piece_name']['position'] rescue 1)
                %td
              %tr
                %td
                  %label.checkbox
                    = check_box_tag "ibiza[description][piece_number][is_used]", 1, (@ibiza.description['piece_number']['is_used'] rescue false)
                    %span.text Référence pièce d'origine
                %td= number_field_tag "ibiza[description][piece_number][position]", (@ibiza.description['piece_number']['position'] rescue 1)
                %td Permet d'afficher dans iBiza une référence dans la colonne Ref pièce d'iBiza (la colonne doit être affichée)
          = f.input :description_separator
        .form-actions.margin0bottom
          = f.submit 'Valider', class: 'btn btn-primary'
          = link_to t('actions.cancel'), account_organization_path(@organization, tab: 'ibiza'), class: 'btn'
